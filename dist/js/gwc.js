"use strict";!function(o){if(localStorage.getItem("name")&&o(".name").html(localStorage.getItem("name")),jscookie.get("num")&&jscookie.get("numsid")){var t=jscookie.get("numsid").split(","),l=jscookie.get("num").split(",");o.each(t,function(i,n){var c,e;c=t[i],e=l[i],o.ajax({url:"http://localhost/php/projectname/php/gwc.php",dataType:"json"}).done(function(i){o.each(i,function(i,n){if(c==n.sid){var t=o(".gwul .gwl:hidden").clone(!0,!0);t.find(".colimg img").attr("src",n.url),t.find(".colimg img").attr("sid",n.sid),t.find(".colname a").html(n.name),t.find(".colprice span").html(n.price),t.find(".colnumjs input").val(e),t.find(".coltotal span").html((n.price*e).toFixed(2)),t.css("display","block"),o(".gwul").append(t),o(".gwlist").find("input").prop("checked",!0),s()}})})})}function s(){var t=0,c=0;o.each(o(".gwl:visible"),function(i,n){o(n).find(".qxcheck input").prop("checked")&&(t+=parseInt(o(n).find(".colnumjs input").val()),c+=parseFloat(o(n).find(".coltotal span").html()))}),o(".spnum").html(t),o(".sp-price em").html(c)}function n(i){return(i.parents(".gwl").find(".colprice span").html()*i.parents(".gwl").find(".colnumjs input").val()).toFixed(2)}o(".qx").on("change",function(){o(".gwul").find(".gwl:visible").find(".qxcheck input ").prop("checked",o(this).prop("checked")),s()}),o(".gwul").on("click",function(){o(".gwl:visible").find(":checkbox").size()===o(".gwl:visible").find(".qxcheck input:checked").size()?o(".qx").prop("checked",!0):o(".qx").prop("checked",!1),s()}),o(".Jadd").on("click",function(){var i=o(this).parents(".colnumjs").find("input").val();i++,o(this).parents(".colnumjs").find("input").val(i++),o(this).parents(".gwl").find(".coltotal span").html(n(o(this))),s(),c(o(this))}),o(".Jj").on("click",function(){var i=o(this).parents(".colnumjs").find("input").val();--i<1&&(i=1),o(this).parents(".colnumjs").find("input").val(i++),o(this).parents(".gwl").find(".coltotal span").html(n(o(this))),s(),c(o(this))});var e=[],a=[];function p(){a=jscookie.get("num")&&jscookie.get("numsid")?(e=jscookie.get("numsid").split(","),jscookie.get("num").split(",")):(e=[],[])}function c(i){p();var n=i.parents(".gwl").find(".colimg img").attr("sid");a[o.inArray(n,e)]=i.parents(".gwl").find(".colnumjs input").val(),jscookie.add("num",a,7)}o(".colaction a").on("click",function(){var t,i,c;p(),window.confirm("你确定删除吗？")&&(o(this).parents(".gwl").remove(),t=o(this).parents(".gwl").find(".colimg img").attr("sid"),i=e,c=void 0,o.each(i,function(i,n){t==n&&(c=i)}),a.splice(c,1),e.splice(c,1),jscookie.add("num",a,7),jscookie.add("numsid",e,7),e.length&&a.length||(jscookie.del("num"),jscookie.del("numsid")),s())})}(jQuery);